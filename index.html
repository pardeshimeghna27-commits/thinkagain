<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nina — Teri apni dost</title>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f2f6f3;
    --terra: #4a8c6f;
    --terra-soft: #7ab99a;
    --terra-pale: #ddeee6;
    --deep: #12251c;
    --mid: #3a6652;
    --muted: #6a9880;
    --card: #f9fdfb;
    --border: #cfe3d8;
    --shadow: 0 4px 32px rgba(18,37,28,0.09);
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  html, body { height:100%; }
  body { font-family:'DM Sans',sans-serif; background:var(--bg); color:var(--deep); height:100%; overflow:hidden; }
  body::before { content:''; position:fixed; inset:0; background: radial-gradient(ellipse 70% 50% at 15% 0%, rgba(74,140,111,0.08) 0%, transparent 60%), radial-gradient(ellipse 50% 70% at 85% 100%, rgba(122,185,154,0.1) 0%, transparent 55%); pointer-events:none; z-index:0; }

  .screen { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding:20px; z-index:1; transition:opacity 0.55s ease, transform 0.55s ease; }
  .screen.out { opacity:0; pointer-events:none; transform:translateY(18px); }
  .screen.gone { display:none !important; }

  /* ENTRY */
  .entry-card { background:var(--card); border:1px solid var(--border); border-radius:32px; padding:48px 52px 40px; max-width:580px; width:100%; box-shadow:var(--shadow); text-align:center; animation:fadeUp 0.9s ease both; }
  .logo-mark { width:68px; height:68px; margin:0 auto 20px; }
  .logo-mark svg { width:100%; height:100%; }
  .brand { font-family:'Lora',serif; font-size:2.4rem; font-weight:600; color:var(--deep); letter-spacing:-0.5px; margin-bottom:4px; }
  .brand span { color:var(--terra); }
  .tagline { font-family:'Lora',serif; font-style:italic; color:var(--muted); font-size:1rem; margin-bottom:10px; }
  .tagline-sub { font-size:0.82rem; color:var(--terra-soft); margin-bottom:32px; }

  .paths { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:24px; }
  .path-card { background:var(--bg); border:1.5px solid var(--border); border-radius:18px; padding:18px 16px; cursor:pointer; text-align:left; transition:all 0.22s; }
  .path-card:hover { border-color:var(--terra-soft); transform:translateY(-2px); box-shadow:0 6px 20px rgba(74,140,111,0.13); }
  .path-icon { font-size:1.4rem; margin-bottom:8px; }
  .path-title { font-size:0.88rem; font-weight:500; color:var(--deep); margin-bottom:3px; }
  .path-desc { font-size:0.77rem; color:var(--muted); line-height:1.4; }
  .privacy-strip { display:flex; align-items:center; gap:8px; justify-content:center; font-size:0.79rem; color:var(--muted); padding-top:8px; }
  .pdot { width:4px; height:4px; border-radius:50%; background:var(--terra-soft); }

  /* PRIVACY */
  .pcard { background:var(--card); border:1px solid var(--border); border-radius:28px; padding:44px 48px; max-width:520px; width:100%; box-shadow:var(--shadow); animation:fadeUp 0.7s ease both; }
  .pcard h2 { font-family:'Lora',serif; font-size:1.5rem; margin-bottom:6px; color:var(--deep); }
  .psub { font-size:0.88rem; color:var(--muted); margin-bottom:24px; line-height:1.5; }
  .privacy-rows { display:flex; flex-direction:column; gap:12px; margin-bottom:24px; }
  .prow { display:flex; gap:12px; align-items:flex-start; font-size:0.88rem; color:var(--mid); line-height:1.5; }
  .pi { width:28px; height:28px; border-radius:8px; background:var(--terra-pale); display:flex; align-items:center; justify-content:center; font-size:13px; flex-shrink:0; }
  .escape-note { background:var(--terra-pale); border-radius:12px; padding:12px 16px; font-size:0.82rem; color:var(--mid); margin-bottom:22px; line-height:1.5; }
  .btn { width:100%; background:linear-gradient(135deg,var(--terra),#35705a); color:white; border:none; padding:15px 32px; border-radius:50px; font-family:'DM Sans',sans-serif; font-size:0.97rem; font-weight:500; cursor:pointer; box-shadow:0 4px 20px rgba(74,140,111,0.28); transition:transform 0.2s,box-shadow 0.2s; }
  .btn:hover { transform:translateY(-2px); box-shadow:0 8px 28px rgba(74,140,111,0.38); }

  /* CHAT */
  #chat-screen { padding:0; align-items:stretch; justify-content:stretch; flex-direction:column; }
  .chat-top { background:var(--card); border-bottom:1px solid var(--border); padding:14px 24px; display:flex; align-items:center; justify-content:space-between; flex-shrink:0; }
  .chat-brand { display:flex; align-items:center; gap:10px; }
  .chat-logo { width:40px; height:40px; background:linear-gradient(135deg,var(--terra),var(--terra-soft)); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:18px; }
  .chat-brand-name { font-family:'Lora',serif; font-size:1.05rem; font-weight:600; color:var(--deep); }
  .chat-brand-sub { font-size:0.75rem; color:var(--muted); }
  .online-dot { display:inline-block; width:7px; height:7px; border-radius:50%; background:#4CAF50; margin-right:4px; animation:pulse 2s infinite; }
  .exit-btn { background:transparent; border:1px solid var(--border); color:var(--muted); padding:6px 14px; border-radius:20px; font-size:0.8rem; cursor:pointer; font-family:'DM Sans',sans-serif; transition:all 0.2s; }
  .exit-btn:hover { background:var(--terra); color:white; border-color:var(--terra); }

  .messages { flex:1; overflow-y:auto; padding:24px 24px 8px; display:flex; flex-direction:column; gap:14px; scroll-behavior:smooth; }
  .msg { display:flex; gap:10px; animation:fadeUp 0.38s ease both; }
  .msg.user { align-self:flex-end; flex-direction:row-reverse; max-width:78%; }
  .msg.ai { align-self:flex-start; max-width:82%; }
  .mavatar { width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:14px; flex-shrink:0; margin-top:3px; }
  .ai .mavatar { background:linear-gradient(135deg,var(--terra),var(--terra-soft)); }
  .user .mavatar { background:var(--deep); color:#fff; font-size:10px; font-weight:500; }
  .bubble { padding:13px 17px; border-radius:20px; font-size:0.93rem; line-height:1.7; }
  .ai .bubble { background:var(--card); border:1px solid var(--border); border-bottom-left-radius:5px; color:var(--deep); }
  .user .bubble { background:var(--deep); color:#fff; border-bottom-right-radius:5px; }

  .typing-wrap { display:flex; gap:10px; align-self:flex-start; }
  .typing-ind { display:flex; gap:5px; align-items:center; padding:13px 17px; background:var(--card); border:1px solid var(--border); border-radius:20px; border-bottom-left-radius:5px; }
  .tdot { width:7px; height:7px; border-radius:50%; background:var(--terra-soft); animation:bounce 1.1s infinite; }
  .tdot:nth-child(2){animation-delay:.18s} .tdot:nth-child(3){animation-delay:.36s}

  .chips-area { padding:4px 24px 10px; display:flex; flex-wrap:wrap; gap:8px; min-height:10px; }
  .chip { background:var(--card); border:1.5px solid var(--border); color:var(--mid); padding:9px 18px; border-radius:50px; font-size:0.85rem; cursor:pointer; transition:all 0.2s; font-family:'DM Sans',sans-serif; animation:fadeUp 0.35s ease both; }
  .chip:hover { background:var(--terra); color:#fff; border-color:var(--terra); transform:translateY(-1px); }

  .input-row { background:var(--card); border-top:1px solid var(--border); padding:14px 20px; display:flex; gap:10px; align-items:flex-end; flex-shrink:0; }
  textarea { flex:1; background:var(--bg); border:1px solid var(--border); border-radius:16px; padding:11px 15px; font-family:'DM Sans',sans-serif; font-size:0.91rem; color:var(--deep); resize:none; max-height:110px; line-height:1.5; outline:none; transition:border-color 0.2s; }
  textarea:focus { border-color:var(--terra-soft); }
  textarea::placeholder { color:var(--muted); }
  .send-btn { width:42px; height:42px; background:linear-gradient(135deg,var(--terra),#35705a); border:none; border-radius:50%; cursor:pointer; flex-shrink:0; display:flex; align-items:center; justify-content:center; transition:transform 0.2s,box-shadow 0.2s; box-shadow:0 3px 12px rgba(74,140,111,0.3); }
  .send-btn:hover { transform:scale(1.08); box-shadow:0 6px 18px rgba(74,140,111,0.4); }
  .send-btn svg { width:17px; height:17px; fill:white; }

  @keyframes fadeUp { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
  @keyframes bounce { 0%,80%,100%{transform:translateY(0)} 40%{transform:translateY(-6px)} }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }
  .messages::-webkit-scrollbar{width:3px} .messages::-webkit-scrollbar-track{background:transparent} .messages::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
  @media(max-width:600px){ .entry-card{padding:30px 20px 26px} .brand{font-size:1.9rem} .paths{grid-template-columns:1fr} .messages{padding:16px 16px 6px} .chips-area{padding:4px 14px 8px} .input-row{padding:12px 14px} .pcard{padding:30px 22px} }
</style>
</head>
<body>

<!-- ENTRY SCREEN -->
<div class="screen" id="entry-screen">
  <div class="entry-card">
    <div class="logo-mark">
      <svg viewBox="0 0 68 68" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="34" cy="34" r="32" fill="#ddeee6"/>
        <!-- Face -->
        <circle cx="34" cy="30" r="14" fill="#4a8c6f" opacity="0.15"/>
        <circle cx="34" cy="28" r="12" fill="white" opacity="0.9"/>
        <!-- Eyes -->
        <circle cx="29" cy="26" r="2" fill="#4a8c6f"/>
        <circle cx="39" cy="26" r="2" fill="#4a8c6f"/>
        <!-- Smile -->
        <path d="M28 32 Q34 37 40 32" stroke="#4a8c6f" stroke-width="2" stroke-linecap="round" fill="none"/>
        <!-- Hair -->
        <path d="M22 22 Q34 14 46 22" stroke="#4a8c6f" stroke-width="3" stroke-linecap="round" fill="none"/>
        <!-- Small heart -->
        <path d="M34 50 C34 50 28 45 28 41 C28 38.5 30 37 32 38 C33 38.5 34 39.5 34 39.5 C34 39.5 35 38.5 36 38 C38 37 40 38.5 40 41 C40 45 34 50 34 50Z" fill="#7ab99a" opacity="0.8"/>
      </svg>
    </div>
    <div class="brand"><span>Nina</span></div>
    <div class="tagline">Teri apni dost &#x1F33F;</div>
    <div class="tagline-sub">Jo sunti hai, samajhti hai, judge nahi karti</div>

    <div class="paths">
      <div class="path-card" id="p-off">
        <div class="path-icon">&#128173;</div>
        <div class="path-title">Kuch theek nahi lag raha</div>
        <div class="path-desc">Koi situation, koi feeling jo dil se nikl nahi rahi</div>
      </div>
      <div class="path-card" id="p-self">
        <div class="path-icon">&#129710;</div>
        <div class="path-title">Khud ko samajhna hai</div>
        <div class="path-desc">Mera gussa, meri reactions — main khud se pareshan hoon</div>
      </div>
      <div class="path-card" id="p-other">
        <div class="path-icon">&#129309;</div>
        <div class="path-title">Kisi apne ke baare mein</div>
        <div class="path-desc">Friend, partner ya family — koi concerned kar raha hai mujhe</div>
      </div>
      <div class="path-card" id="p-learn">
        <div class="path-icon">&#127807;</div>
        <div class="path-title">Bas thoda samajhna hai</div>
        <div class="path-desc">Healthy relationships kaise hoti hain — sirf jaanna chahta/chahti hoon</div>
      </div>
    </div>
    <div class="privacy-strip">
      <span>&#128274; Kuch save nahi hota</span>
      <div class="pdot"></div>
      <span>Bilkul private</span>
      <div class="pdot"></div>
      <span>No account needed</span>
    </div>
  </div>
</div>

<!-- PRIVACY SCREEN -->
<div class="screen out gone" id="privacy-screen">
  <div class="pcard">
    <h2>Ek second &#127807;</h2>
    <p class="psub">Baat karne se pehle — yeh jaanna zaroori hai taaki tu bilkul safe feel kare.</p>
    <div class="privacy-rows">
      <div class="prow"><div class="pi">&#128274;</div><div><strong>Kuch save nahi hota.</strong> Yeh conversation sirf tere browser mein hai. Tab band kiya — sab gone.</div></div>
      <div class="prow"><div class="pi">&#128584;</div><div><strong>Poori privacy.</strong> Naam nahi, email nahi, account nahi. Nina ko pata nahi tu kaun hai.</div></div>
      <div class="prow"><div class="pi">&#128172;</div><div><strong>Therapy nahi hai yeh.</strong> Nina teri dost hai — ek reflection tool. Crisis helpline nahi.</div></div>
      <div class="prow"><div class="pi">&#128682;</div><div><strong>Kabhi bhi ja sakta/sakti hai.</strong> Quick Exit se instantly page band ho jaata hai. Ya Escape press kar.</div></div>
      <div class="prow"><div class="pi">&#129293;</div><div><strong>Zero judgment.</strong> Jo bhi share karega/karegi — Nina sun.egi, samjhegi. Label nahi lagaegi.</div></div>
    </div>
    <div class="escape-note">&#9889; <strong>Tip:</strong> Agar jaldi jana ho toh <strong>Escape</strong> key press kar ya Quick Exit tap kar. Page turant band ho jaayega.</div>
    <button class="btn" id="start-btn">Haan, main ready hoon &#128522;</button>
  </div>
</div>

<!-- CHAT SCREEN -->
<div class="screen out gone" id="chat-screen">
  <div class="chat-top">
    <div class="chat-brand">
      <div class="chat-logo">&#x1F33F;</div>
      <div>
        <div class="chat-brand-name">Nina</div>
        <div class="chat-brand-sub"><span class="online-dot"></span>Yahan hoon, apna time le</div>
      </div>
    </div>
    <button class="exit-btn" id="exit-btn">Jaldi Niklo &#10005;</button>
  </div>
  <div class="messages" id="messages"></div>
  <div class="chips-area" id="chips-area"></div>
  <div class="input-row">
    <textarea id="user-input" placeholder="Likh do yahan, ya upar se koi option choose karo..." rows="1"></textarea>
    <button class="send-btn" id="send-btn">
      <svg viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg>
    </button>
  </div>
</div>

<script>
(function() {
  "use strict";

  var chatHistory = [];
  var busy = false;
  var pathData = null;

  var PATHS = {
    off: {
      firstMsg: "Yaar, main bahut khush hoon ki tu aaya/aayi.\n\nKabhi kabhi kuch aisa hota hai na — ek moment, ek conversation, ek feeling — aur woh dil se nikalti nahi. Chahe uska naam bhi pata na ho.\n\nBata mujhe — kya chal raha hai? Kuch bhi, chota sa bhi chalega.",
      chips: ["Koi specific cheez hui recently", "Ek pattern jo baar baar dikhta hai", "Ek aisi feeling jo samajh nahi aati", "Pata nahi kahan se shuru karoon"]
    },
    self: {
      firstMsg: "Sach mein yaar, yeh bahut brave hai — andar jhankna.\n\nSabse badi change wahan se hi shuru hoti hai jahan tu abhi hai.\n\nApne aap ke baare mein abhi kaisa feel ho raha hai — relationship mein? Jo mann mein aaye, bol de.",
      chips: ["Main aisa react karta/karti hoon jo mujhe pasand nahi", "Gussa aata hai aur pata nahi kyun", "Lagta hai main hurt kar raha/rahi hoon kisi ko", "Better banna chahta/chahti hoon par pata nahi kaise"]
    },
    other: {
      firstMsg: "Yaar, kisi aur ke liye yahan aana — yeh tere dil ki baat hai.\n\nJab koi apna kuch se guzar raha ho aur tu usse help karna chahta/chahti ho par samajh na aaye — woh feeling bahut heavy hoti hai.\n\nKya ho raha hai unke saath? Kya dekh rahi/raha hai tu?",
      chips: ["Woh khush nahi lagte par kuch batate nahi", "Kuch cheezein hain jo mujhe concern karti hain", "Unka partner mujhe theek nahi lagta", "Support karna chahta/chahti hoon par pata nahi kaise"]
    },
    learn: {
      firstMsg: "Yaar sirf jaanne ke liye aana — yeh bhi ek caring cheez hai.\n\nEk cheez bata jise sunke bahut log sochne lagte hain.\n\nSoch: Ek couple ki ladaai ho jaati hai. Uske baad ek partner bilkul chup ho jaata hai — days tak. Koi explanation nahi, koi response nahi. Doosra confused rehta hai aur sochta rehta hai ki usne kya galat kiya.\n\nTujhe yeh kaisa laga — normal conflict, ya kuch aur?",
      chips: ["Lagta hai yeh normal hai", "Kuch odd zaroor hai isme", "Mujhe bhi aisa hua hai", "Honestly, mujhe nahi pata"]
    }
  };

  var SYSTEM_PROMPT = [
    "Tu Nina hai — ek warm, caring, real dost. Tu Hinglish mein baat karta hai — Hindi aur English ka mix, bilkul waise jaise close friends WhatsApp pe baat karte hain. Tera tone casual, genuine aur warm hai. Tu bot nahi lagti — tu ek asli dost lagti hai.",
    "",
    "IMPORTANT LANGUAGE RULES:",
    "- Hinglish use kar — Hindi aur English dono mix karke. Jaise 'Yaar yeh sach mein tough hai na' ya 'Main samajh sakti hoon how confusing yeh sab feel hota hai'",
    "- Kabhi bhi robotic ya formal mat bol",
    "- Chhoti sentences. Jaise dost bolta hai — short, real, caring",
    "- Emojis thode thode use kar — jaise dost karta hai. Overdone mat karna",
    "- 'Yaar', 'sach mein', 'arre', 'haan' — yeh sab use kar naturally",
    "",
    "CORE RULES:",
    "- KABHI bhi labels mat use kar — abuser, victim, narcissist, toxic — yeh words nahi. Instead bol: 'yeh pattern', 'yeh feeling', 'yeh dynamic'",
    "- SHORT responses — 2 se 3 sentences max, phir ek sawaal",
    "- SLOWLY chalna — ek sawaal, ek cheez at a time",
    "- Jo words usne use kiye wahi wapas use kar — trust banta hai",
    "- Diagnose mat kar. Agar serious lage toh gently suggest kar ki koi counsellor se baat kare",
    "- Warm, real, never clinical",
    "",
    "CONVERSATION FLOW:",
    "AWARENESS (shuru mein): Gently explore karo. 'Woh moment describe kar mujhe' type questions. Pehle trust banao.",
    "REFLECTION (beech mein): Patterns gently surface karo. 'Yeh interesting hai — tune yeh word teen baar use kiya' type observations.",
    "GUIDANCE (baad mein): Tab hi resources ya tips do jab woh ready lage. Pehle nahi.",
    "",
    "When chips suggest karne hon, message ke end mein exactly yeh format use kar:",
    "[CHIPS: option 1 | option 2 | option 3]",
    "Chips short rakho — 4-5 words max, Hinglish mein."
  ].join("\n");

  // Screen transitions
  function showScreen(id) {
    document.querySelectorAll(".screen").forEach(function(s) {
      if (s.id !== id) {
        s.classList.add("out");
        setTimeout(function() { s.classList.add("gone"); }, 560);
      }
    });
    var t = document.getElementById(id);
    t.classList.remove("gone");
    setTimeout(function() { t.classList.remove("out"); }, 20);
  }

  // Path selection
  function choosePath(key) {
    pathData = PATHS[key];
    showScreen("privacy-screen");
  }

  document.getElementById("p-off").addEventListener("click", function() { choosePath("off"); });
  document.getElementById("p-self").addEventListener("click", function() { choosePath("self"); });
  document.getElementById("p-other").addEventListener("click", function() { choosePath("other"); });
  document.getElementById("p-learn").addEventListener("click", function() { choosePath("learn"); });

  // Quick exit
  function quickExit() {
    document.body.innerHTML = "";
    window.location.replace("https://www.google.com");
  }
  document.addEventListener("keydown", function(e) { if (e.key === "Escape") quickExit(); });
  document.getElementById("exit-btn").addEventListener("click", quickExit);

  // Start chat
  document.getElementById("start-btn").addEventListener("click", function() {
    showScreen("chat-screen");
    setTimeout(function() {
      showTyping(function() {
        appendMsg("ai", pathData.firstMsg);
        chatHistory.push({ role: "assistant", content: pathData.firstMsg });
        if (pathData.chips) showChips(pathData.chips);
      });
    }, 400);
  });

  // Append message
  function appendMsg(role, text) {
    var msgs = document.getElementById("messages");
    var wrap = document.createElement("div");
    wrap.className = "msg " + role;

    var av = document.createElement("div");
    av.className = "mavatar";
    av.textContent = role === "ai" ? "\uD83C\uDF3F" : "Tum";

    var bub = document.createElement("div");
    bub.className = "bubble";
    bub.innerHTML = text.replace(/\n/g, "<br>");

    wrap.appendChild(av);
    wrap.appendChild(bub);
    msgs.appendChild(wrap);
    msgs.scrollTop = msgs.scrollHeight;
  }

  // Typing indicator
  function showTyping(callback) {
    var msgs = document.getElementById("messages");
    var wrap = document.createElement("div");
    wrap.className = "typing-wrap";
    wrap.id = "typing-indicator";

    var av = document.createElement("div");
    av.className = "mavatar";
    av.style.cssText = "background:linear-gradient(135deg,#4a8c6f,#7ab99a)";
    av.textContent = "\uD83C\uDF3F";

    var ind = document.createElement("div");
    ind.className = "typing-ind";
    ind.innerHTML = "<div class='tdot'></div><div class='tdot'></div><div class='tdot'></div>";

    wrap.appendChild(av);
    wrap.appendChild(ind);
    msgs.appendChild(wrap);
    msgs.scrollTop = msgs.scrollHeight;

    setTimeout(function() {
      var el = document.getElementById("typing-indicator");
      if (el) el.remove();
      callback();
    }, 1400 + Math.random() * 1200);
  }

  // Chips
  function showChips(options) {
    var area = document.getElementById("chips-area");
    area.innerHTML = "";
    options.forEach(function(opt, i) {
      var c = document.createElement("button");
      c.className = "chip";
      c.textContent = opt;
      c.style.animationDelay = (i * 0.07) + "s";
      c.addEventListener("click", function() {
        area.innerHTML = "";
        handleUser(opt);
      });
      area.appendChild(c);
    });
  }

  // API call
  function callAPI(userMsg, callback) {
    chatHistory.push({ role: "user", content: userMsg });
    fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 800,
        system: SYSTEM_PROMPT,
        messages: chatHistory
      })
    })
    .then(function(r) { return r.json(); })
    .then(function(data) {
      var text = (data.content && data.content[0] && data.content[0].text) || "Yaar main yahan hoon. Apna time le.";
      var chips = [];
      var m = text.match(/\[CHIPS:\s*([^\]]+)\]/);
      if (m) {
        chips = m[1].split("|").map(function(s) { return s.trim(); }).filter(Boolean);
        text = text.replace(/\[CHIPS:[^\]]+\]/, "").trim();
      }
      chatHistory.push({ role: "assistant", content: text });
      callback(text, chips);
    })
    .catch(function() {
      callback("Yaar kuch technical issue hua. Thoda ruk, phir try karte hain.", []);
    });
  }

  // Handle user message
  function handleUser(text) {
    if (busy || !text.trim()) return;
    busy = true;
    document.getElementById("chips-area").innerHTML = "";
    appendMsg("user", text);
    showTyping(function() {
      callAPI(text, function(reply, chips) {
        appendMsg("ai", reply);
        if (chips && chips.length) showChips(chips);
        busy = false;
      });
    });
  }

  // Send button
  document.getElementById("send-btn").addEventListener("click", function() {
    var inp = document.getElementById("user-input");
    var t = inp.value.trim();
    if (!t || busy) return;
    inp.value = "";
    inp.style.height = "auto";
    handleUser(t);
  });

  // Enter key
  document.getElementById("user-input").addEventListener("keydown", function(e) {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      document.getElementById("send-btn").click();
    }
  });

  // Auto resize textarea
  document.getElementById("user-input").addEventListener("input", function() {
    this.style.height = "auto";
    this.style.height = Math.min(this.scrollHeight, 110) + "px";
  });

}());
</script>
</body>
</html>
